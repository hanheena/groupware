<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.teraenergy.dashboard.mapper.ScheduleMapper">
	
	<!-- 캘린더 일정 정보 가져오기 -->
	<select id="get_calender" resultType="java.util.HashMap">
		SELECT
		id, title, description, write_user, target_user, write_date,
		IF(all_day, 'true', 'false') AS all_day,
		start, end,
		(CASE WHEN event_type = 1 THEN '공통'
		WHEN event_type = 2 THEN '내일정'
		WHEN event_type = 3 THEN '공유일정'
		ELSE 'null' END) AS 'event_type',
		file_path, backgroundColor, textColor
		FROM test_tbl
		ORDER BY id DESC
	</select>
	
	<!-- 일정 등록 -->
	<insert id="insert_schedule">
		INSERT INTO test_tbl(
		title, start, end, 
		description, event_type, 
		write_user, backgroundColor, 
		textColor, all_day
	    )
	    VALUES (
	    #{m.title}, #{m.start}, #{m.end}, 
	    #{m.description}, #{m.event_type},
	    #{m.write_user}, #{m.backgroundColor}, 
	    #{m.textColor}, #{m.all_day}
	    )
	</insert>
	
	<!-- 일정 수정 -->
	<update id="update_schedule">
		UPDATE test_tbl SET
		title = #{m.title}, start = #{m.start}, end = #{m.end}, 
		description = #{m.description}, event_type = #{m.event_type}, 
		write_user = #{m.write_user}, backgroundColor =  #{m.backgroundColor}, 
		textColor = #{m.textColor}, all_day = #{m.all_day} 
		WHERE id = #{m.id}
	</update>
	
	<!-- 일정 삭제 -->
	<delete id="delete_schedule">
		DELETE FROM test_tbl WHERE id = #{check_id};
	</delete>
</mapper>